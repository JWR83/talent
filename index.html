<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Talent Ranker">
  <title>Podcast Talent Ranker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }
    .card-hover {
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }
    .card-hover:hover {
      transform: translateY(-4px);
      border-color: #0891b2;
      box-shadow: 0 20px 25px -5px rgba(8, 145, 178, 0.2), 0 10px 10px -5px rgba(8, 145, 178, 0.1);
    }
    .tooltip-wrapper {
      position: relative;
      cursor: help;
    }
    .tooltip-wrapper .tooltip-text {
      visibility: hidden;
      width: 200px;
      background-color: #1e293b;
      color: #fff;
      text-align: left;
      border-radius: 6px;
      padding: 8px 12px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      margin-left: -100px;
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 12px;
      line-height: 1.4;
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    }
    .tooltip-wrapper .tooltip-text::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: #1e293b transparent transparent transparent;
    }
    .tooltip-wrapper:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body class="bg-sky-50">
  <div id="app">Loading Talent Ranker...</div>

  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <script>
    window.addEventListener('load', function() {
      if (typeof React === 'undefined' || typeof ReactDOM === 'undefined') {
        document.getElementById('app').innerHTML = '<div style="padding:40px;">Error: React did not load.</div>';
        return;
      }
      
      const SupabaseLib = window.supabase || window.supabaseJs || window.Supabase;
      if (!SupabaseLib) {
        document.getElementById('app').innerHTML = '<div style="padding:40px;">Error: Supabase library blocked.</div>';
        return;
      }
      
      const supabase = SupabaseLib.createClient(
        'https://ipsyadzxbcmeystppqsa.supabase.co',
        'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlwc3lhZHp4YmNtZXlzdHBwcXNhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg2MDI3NDQsImV4cCI6MjA4NDE3ODc0NH0.43PO69dCcWQL0TuGtrP02rpn8XxCy4Qi0CtHUhNS72k'
      );
    
    const { createElement: h, useState, useEffect, useMemo } = React;
    
    const PlusIcon = () => h('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
      h('line', { x1: 12, y1: 5, x2: 12, y2: 19 }),
      h('line', { x1: 5, y1: 12, x2: 19, y2: 12 })
    );
    
    const TrashIcon = () => h('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
      h('polyline', { points: '3 6 5 6 21 6' }),
      h('path', { d: 'M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2' })
    );
    
    const UsersIcon = () => h('svg', { width: 16, height: 16, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
      h('path', { d: 'M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2' }),
      h('circle', { cx: 9, cy: 7, r: 4 }),
      h('path', { d: 'M23 21v-2a4 4 0 0 0-3-3.87' }),
      h('path', { d: 'M16 3.13a4 4 0 0 1 0 7.75' })
    );
    
    const AwardIcon = () => h('svg', { width: 24, height: 24, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
      h('circle', { cx: 12, cy: 8, r: 7 }),
      h('polyline', { points: '8.21 13.89 7 23 12 20 17 23 15.79 13.88' })
    );

    const SearchIcon = () => h('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
      h('circle', { cx: 11, cy: 11, r: 8 }),
      h('path', { d: 'm21 21-4.35-4.35' })
    );

    const ExternalLinkIcon = () => h('svg', { width: 16, height: 16, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, className: 'inline ml-1' },
      h('path', { d: 'M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6' }),
      h('polyline', { points: '15 3 21 3 21 9' }),
      h('line', { x1: 10, y1: 14, x2: 21, y2: 3 })
    );

    const YoutubeIcon = () => h('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'currentColor' },
      h('path', { d: 'M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z' })
    );

    const DollarIcon = () => h('svg', { width: 16, height: 16, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
      h('line', { x1: 12, y1: 1, x2: 12, y2: 23 }),
      h('path', { d: 'M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6' })
    );

    const TrendingUpIcon = () => h('svg', { width: 16, height: 16, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 },
      h('polyline', { points: '23 6 13.5 15.5 8.5 10.5 1 18' }),
      h('polyline', { points: '17 6 23 6 23 12' })
    );

    const App = () => {
      const [talents, setTalents] = useState([]);
      const [weights, setWeights] = useState({
        engagement: 25,
        contentQuality: 20,
        growthPotential: 20,
        productionValue: 15,
        brandFit: 20
      });
      const [showAddForm, setShowAddForm] = useState(false);
      const [editingTalent, setEditingTalent] = useState(null);
      const [newTalent, setNewTalent] = useState({
        name: '',
        show_name: '',
        audience_size: '',
        niche: '',
        youtube_url: '',
        cpm: '',
        rpm: '',
        growth_28_day: '',
        growth_3_month: '',
        growth_12_month: '',
        x_followers: '',
        instagram_followers: '',
        tiktok_followers: '',
        snapchat_followers: '',
        facebook_followers: '',
        engagement: 5,
        content_quality: 5,
        growth_potential: 5,
        production_value: 5,
        brand_fit: 5,
        notes: ''
      });
      const [sortBy, setSortBy] = useState('score');
      const [searchQuery, setSearchQuery] = useState('');
      const [revenueFilter, setRevenueFilter] = useState('all');
      const [loading, setLoading] = useState(true);
      const [showMigration, setShowMigration] = useState(false);

      // Load talents from Supabase
      const loadTalents = async () => {
        setLoading(true);
        try {
          const { data, error } = await supabase
            .from('talents')
            .select('*')
            .order('created_at', { ascending: true });
          
          if (error) throw error;
          setTalents(data || []);
        } catch (error) {
          console.error('Error loading talents:', error);
          alert('Error loading talents from database');
        } finally {
          setLoading(false);
        }
      };

      useEffect(() => {
        loadTalents();
        
        const savedWeights = localStorage.getItem('podcastWeights');
        if (savedWeights) {
          try {
            setWeights(JSON.parse(savedWeights));
          } catch (e) {
            console.error('Error loading weights', e);
          }
        }
      }, []);

      useEffect(() => {
        try {
          localStorage.setItem('podcastWeights', JSON.stringify(weights));
        } catch (e) {
          console.error('Error saving weights', e);
        }
      }, [weights]);

      const calculateScore = (talent) => {
        return (
          (talent.engagement * weights.engagement +
           talent.content_quality * weights.contentQuality +
           talent.growth_potential * weights.growthPotential +
           talent.production_value * weights.productionValue +
           talent.brand_fit * weights.brandFit) / 100
        ).toFixed(2);
      };

      // Helper function to parse dollar values
      const parseDollarValue = (str) => {
        if (!str) return 0;
        return parseFloat(str.replace(/[$,]/g, '')) || 0;
      };

      // Categorize CPM/RPM into tranches
      const getRevenueTrancheLabel = (talent) => {
        const cpm = parseDollarValue(talent.cpm);
        const rpm = parseDollarValue(talent.rpm);
        const avgRevenue = (cpm + rpm) / 2;
        
        if (avgRevenue >= 9) return 'high';
        if (avgRevenue >= 6) return 'medium';
        return 'low';
      };

      const sortedTalents = useMemo(() => {
        let filtered = talents;
        
        if (searchQuery.trim() !== '') {
          const query = searchQuery.toLowerCase();
          filtered = talents.filter(t => {
            const nameMatch = t.name.toLowerCase().includes(query);
            const nicheMatch = t.niche && t.niche.toLowerCase().includes(query);
            const cpmMatch = t.cpm && t.cpm.toLowerCase().includes(query);
            const rpmMatch = t.rpm && t.rpm.toLowerCase().includes(query);
            
            return nameMatch || nicheMatch || cpmMatch || rpmMatch;
          });
          
          filtered.sort((a, b) => {
            const aNameMatch = a.name.toLowerCase().includes(query);
            const bNameMatch = b.name.toLowerCase().includes(query);
            if (aNameMatch && !bNameMatch) return -1;
            if (!aNameMatch && bNameMatch) return 1;
            return 0;
          });
        }

        if (revenueFilter !== 'all') {
          filtered = filtered.filter(t => {
            const tranche = getRevenueTrancheLabel(t);
            return tranche === revenueFilter;
          });
        }

        const sorted = filtered.map(t => ({
          ...t,
          score: parseFloat(calculateScore(t))
        }));

        if (!searchQuery.trim() || sortBy !== 'score') {
          sorted.sort((a, b) => {
            if (sortBy === 'score') return b.score - a.score;
            if (sortBy === 'name') return a.name.localeCompare(b.name);
            if (sortBy === 'niche') return (a.niche || '').localeCompare(b.niche || '');
            if (sortBy === 'revenue') {
              const trancheOrder = { 'high': 3, 'medium': 2, 'low': 1 };
              const aTranche = getRevenueTrancheLabel(a);
              const bTranche = getRevenueTrancheLabel(b);
              const diff = trancheOrder[bTranche] - trancheOrder[aTranche];
              if (diff === 0) {
                const aAvg = (parseDollarValue(a.cpm) + parseDollarValue(a.rpm)) / 2;
                const bAvg = (parseDollarValue(b.cpm) + parseDollarValue(b.rpm)) / 2;
                return bAvg - aAvg;
              }
              return diff;
            }
            return 0;
          });
        }

        return sorted;
      }, [talents, weights, sortBy, searchQuery, revenueFilter]);

      const addTalent = async () => {
        if (!newTalent.name || !newTalent.show_name) {
          alert('Name and Show Name are required');
          return;
        }

        try {
          const { data, error } = await supabase
            .from('talents')
            .insert([newTalent])
            .select();
          
          if (error) throw error;
          
          await loadTalents();
          setNewTalent({
            name: '',
            show_name: '',
            audience_size: '',
            niche: '',
            youtube_url: '',
            cpm: '',
            rpm: '',
            growth_28_day: '',
            growth_3_month: '',
            growth_12_month: '',
            x_followers: '',
            instagram_followers: '',
            tiktok_followers: '',
            snapchat_followers: '',
            facebook_followers: '',
            engagement: 5,
            content_quality: 5,
            growth_potential: 5,
            production_value: 5,
            brand_fit: 5,
            notes: ''
          });
          setShowAddForm(false);
        } catch (error) {
          console.error('Error adding talent:', error);
          alert('Error adding talent to database');
        }
      };

      const updateTalent = async () => {
        if (!editingTalent.name || !editingTalent.show_name) {
          alert('Name and Show Name are required');
          return;
        }

        try {
          const { id, score, created_at, ...updateData } = editingTalent;
          
          const { error } = await supabase
            .from('talents')
            .update(updateData)
            .eq('id', id);
          
          if (error) throw error;
          
          await loadTalents();
          setEditingTalent(null);
        } catch (error) {
          console.error('Error updating talent:', error);
          alert('Error updating talent in database');
        }
      };

      const deleteTalent = async (id) => {
        if (!confirm('Are you sure you want to delete this talent?')) return;

        try {
          const { error } = await supabase
            .from('talents')
            .delete()
            .eq('id', id);
          
          if (error) throw error;
          
          await loadTalents();
        } catch (error) {
          console.error('Error deleting talent:', error);
          alert('Error deleting talent from database');
        }
      };

      const migrateDefaultData = async () => {
        if (!confirm('This will add all 36 default talents to your database. Continue?')) return;

        const defaultTalents = [
          {
            name: "Ryan Scribner",
            show_name: "Ryan Scribner",
            audience_size: "862K",
            niche: "Personal Finance",
            youtube_url: "https://www.youtube.com/@RyanScribner",
            cpm: "$8.50",
            rpm: "$6.20",
            engagement: 8,
            content_quality: 8,
            growth_potential: 7,
            production_value: 7,
            brand_fit: 8,
            notes: "Strong finance content creator"
          },
          {
            name: "Nischa",
            show_name: "Nischa",
            audience_size: "2.06M",
            niche: "Personal Finance",
            youtube_url: "https://www.youtube.com/@nischa",
            cpm: "$12.30",
            rpm: "$9.80",
            engagement: 9,
            content_quality: 8,
            growth_potential: 7,
            production_value: 8,
            brand_fit: 9,
            notes: "Popular finance channel"
          },
          {
            name: "Nate O'Brien",
            show_name: "Nate O'Brien",
            audience_size: "1.29M",
            niche: "Personal Finance",
            youtube_url: "https://www.youtube.com/@NateOBrien",
            cpm: "$10.50",
            rpm: "$8.40",
            engagement: 9,
            content_quality: 9,
            growth_potential: 7,
            production_value: 8,
            brand_fit: 9,
            notes: "Top finance YouTuber"
          },
          {
            name: "WhiteBoard Finance",
            show_name: "WhiteBoard Finance",
            audience_size: "1.02M",
            niche: "Personal Finance",
            youtube_url: "https://www.youtube.com/@WhiteBoardFinance",
            cpm: "$9.20",
            rpm: "$7.10",
            engagement: 8,
            content_quality: 8,
            growth_potential: 7,
            production_value: 7,
            brand_fit: 8,
            notes: "Educational finance content"
          },
          {
            name: "BeatTheBush",
            show_name: "BeatTheBush",
            audience_size: "390K",
            niche: "Personal Finance",
            youtube_url: "https://www.youtube.com/@BeatTheBush",
            cpm: "$7.80",
            rpm: "$5.90",
            engagement: 7,
            content_quality: 7,
            growth_potential: 6,
            production_value: 6,
            brand_fit: 7,
            notes: "Finance tips and tricks"
          },
          {
            name: "Kevin Powell",
            show_name: "Kevin Powell",
            audience_size: "997K",
            niche: "Technology",
            youtube_url: "https://www.youtube.com/@KevinPowell",
            cpm: "$6.50",
            rpm: "$4.80",
            engagement: 8,
            content_quality: 9,
            growth_potential: 8,
            production_value: 8,
            brand_fit: 8,
            notes: "CSS and web development"
          },
          {
            name: "TechMeOut",
            show_name: "TechMeOut",
            audience_size: "398K",
            niche: "Technology",
            youtube_url: "https://www.youtube.com/@Techmeout",
            cpm: "$5.90",
            rpm: "$4.20",
            engagement: 7,
            content_quality: 7,
            growth_potential: 7,
            production_value: 7,
            brand_fit: 7,
            notes: "Tech reviews and tutorials"
          },
          {
            name: "Premiere Gal",
            show_name: "Premiere Gal",
            audience_size: "593K",
            niche: "Technology",
            youtube_url: "https://www.youtube.com/@PremiereGal",
            cpm: "$6.80",
            rpm: "$5.10",
            engagement: 8,
            content_quality: 8,
            growth_potential: 7,
            production_value: 8,
            brand_fit: 8,
            notes: "Video editing tutorials"
          },
          {
            name: "The Future Tech",
            show_name: "The Future Tech",
            audience_size: "696K",
            niche: "Technology",
            youtube_url: "https://www.youtube.com/channel/UC17Uwo5BkSTtGVbOkywJ7_Q",
            cpm: "$7.20",
            rpm: "$5.50",
            engagement: 8,
            content_quality: 7,
            growth_potential: 8,
            production_value: 7,
            brand_fit: 8,
            notes: "Future tech trends"
          },
          {
            name: "Pat Flynn",
            show_name: "Pat Flynn",
            audience_size: "480K",
            niche: "Digital Marketing",
            youtube_url: "https://www.youtube.com/@patflynn",
            cpm: "$11.20",
            rpm: "$9.10",
            engagement: 9,
            content_quality: 9,
            growth_potential: 7,
            production_value: 8,
            brand_fit: 9,
            notes: "Passive income expert"
          },
          {
            name: "Marcus Campbell",
            show_name: "Marcus Campbell",
            audience_size: "273K",
            niche: "Affiliate Marketing",
            youtube_url: "https://www.youtube.com/@affiliatemarketingdude",
            cpm: "$8.90",
            rpm: "$6.70",
            engagement: 7,
            content_quality: 7,
            growth_potential: 6,
            production_value: 6,
            brand_fit: 7,
            notes: "Affiliate marketing strategies"
          },
          {
            name: "H-Educate",
            show_name: "H-Educate",
            audience_size: "1M",
            niche: "Digital Marketing",
            youtube_url: "https://www.youtube.com/@hasanaboulhasan",
            cpm: "$9.50",
            rpm: "$7.30",
            engagement: 8,
            content_quality: 8,
            growth_potential: 8,
            production_value: 7,
            brand_fit: 8,
            notes: "Marketing education"
          },
          {
            name: "Matt Diggity",
            show_name: "Matt Diggity",
            audience_size: "172K",
            niche: "Digital Marketing",
            youtube_url: "https://www.youtube.com/@MattDiggity",
            cpm: "$10.80",
            rpm: "$8.60",
            engagement: 8,
            content_quality: 9,
            growth_potential: 8,
            production_value: 7,
            brand_fit: 8,
            notes: "SEO and digital marketing"
          },
          {
            name: "Adrian Brambila",
            show_name: "Adrian Brambila",
            audience_size: "148K",
            niche: "Affiliate Marketing",
            youtube_url: "https://www.youtube.com/@brambilabong",
            cpm: "$8.20",
            rpm: "$6.10",
            engagement: 7,
            content_quality: 7,
            growth_potential: 7,
            production_value: 6,
            brand_fit: 7,
            notes: "Side hustle content"
          },
          {
            name: "Gillian Perkins",
            show_name: "Gillian Perkins",
            audience_size: "730K",
            niche: "Business",
            youtube_url: "https://www.youtube.com/@gillianzperkins",
            cpm: "$9.80",
            rpm: "$7.50",
            engagement: 8,
            content_quality: 8,
            growth_potential: 7,
            production_value: 8,
            brand_fit: 8,
            notes: "Online business strategies"
          },
          {
            name: "Goal 90",
            show_name: "Goal 90",
            audience_size: "484K",
            niche: "Entrepreneurship",
            youtube_url: "https://www.youtube.com/@Goal_90",
            cpm: "$7.60",
            rpm: "$5.80",
            engagement: 7,
            content_quality: 7,
            growth_potential: 7,
            production_value: 6,
            brand_fit: 7,
            notes: "Entrepreneurship content"
          },
          {
            name: "Eleni Fit",
            show_name: "Eleni Fit",
            audience_size: "2.26M",
            niche: "Health & Fitness",
            youtube_url: "https://www.youtube.com/@EleniFit",
            cpm: "$5.20",
            rpm: "$3.90",
            engagement: 8,
            content_quality: 8,
            growth_potential: 7,
            production_value: 8,
            brand_fit: 8,
            notes: "Fitness and wellness"
          },
          {
            name: "Ben Parkes",
            show_name: "Ben Parkes",
            audience_size: "315K",
            niche: "Health & Fitness",
            youtube_url: "https://www.youtube.com/@BenParkes",
            cpm: "$4.80",
            rpm: "$3.50",
            engagement: 7,
            content_quality: 8,
            growth_potential: 7,
            production_value: 7,
            brand_fit: 7,
            notes: "Running channel"
          },
          {
            name: "Diana Ruiz",
            show_name: "Diana Ruiz",
            audience_size: "351K",
            niche: "Health & Fitness",
            youtube_url: "https://www.youtube.com/@dianaruiz",
            cpm: "$5.10",
            rpm: "$3.80",
            engagement: 7,
            content_quality: 7,
            growth_potential: 7,
            production_value: 7,
            brand_fit: 7,
            notes: "Fitness content creator"
          },
          {
            name: "BiggerPockets",
            show_name: "BiggerPockets",
            audience_size: "1.25M",
            niche: "Real Estate",
            youtube_url: "https://www.youtube.com/@biggerpockets",
            cpm: "$13.50",
            rpm: "$11.20",
            engagement: 8,
            content_quality: 9,
            growth_potential: 7,
            production_value: 8,
            brand_fit: 9,
            notes: "Leading real estate education"
          },
          {
            name: "Kris Krohn",
            show_name: "Kris Krohn",
            audience_size: "1.12M",
            niche: "Real Estate",
            youtube_url: "https://www.youtube.com/channel/UCokIq0eihRhkiqClyV0WCdw",
            cpm: "$11.80",
            rpm: "$9.50",
            engagement: 8,
            content_quality: 7,
            growth_potential: 7,
            production_value: 7,
            brand_fit: 8,
            notes: "Real estate investing"
          },
          {
            name: "Jerry Norton",
            show_name: "Jerry Norton",
            audience_size: "540K",
            niche: "Real Estate",
            youtube_url: "https://www.youtube.com/@FlippingMastery",
            cpm: "$12.20",
            rpm: "$10.10",
            engagement: 7,
            content_quality: 8,
            growth_potential: 7,
            production_value: 7,
            brand_fit: 8,
            notes: "House flipping strategies"
          },
          {
            name: "Phil Pustejovsky",
            show_name: "Phil Pustejovsky",
            audience_size: "324K",
            niche: "Real Estate",
            youtube_url: "https://www.youtube.com/@freedom_mentor",
            cpm: "$10.90",
            rpm: "$8.80",
            engagement: 7,
            content_quality: 7,
            growth_potential: 6,
            production_value: 6,
            brand_fit: 7,
            notes: "Real estate investing education"
          },
          {
            name: "Ken McElroy",
            show_name: "Ken McElroy",
            audience_size: "506K",
            niche: "Real Estate",
            youtube_url: "https://www.youtube.com/@KenMcElroy",
            cpm: "$12.80",
            rpm: "$10.50",
            engagement: 8,
            content_quality: 8,
            growth_potential: 7,
            production_value: 7,
            brand_fit: 8,
            notes: "Commercial real estate expert"
          },
          {
            name: "Simply Quinoa",
            show_name: "Simply Quinoa",
            audience_size: "512K",
            niche: "Food & Cooking",
            youtube_url: "https://www.youtube.com/@Simplyquinoa",
            cpm: "$6.20",
            rpm: "$4.60",
            engagement: 7,
            content_quality: 8,
            growth_potential: 6,
            production_value: 8,
            brand_fit: 7,
            notes: "Healthy cooking content"
          },
          {
            name: "Malvika Sitlani",
            show_name: "Malvika Sitlani",
            audience_size: "837K",
            niche: "Beauty & Fashion",
            youtube_url: "https://www.youtube.com/@malvikasitlaniofficial",
            cpm: "$7.40",
            rpm: "$5.60",
            engagement: 8,
            content_quality: 8,
            growth_potential: 7,
            production_value: 8,
            brand_fit: 8,
            notes: "Beauty and lifestyle"
          },
          {
            name: "Roshni Bhatia",
            show_name: "Roshni Bhatia",
            audience_size: "567K",
            niche: "Beauty & Fashion",
            youtube_url: "https://www.youtube.com/@RoshniBhatia",
            cpm: "$6.90",
            rpm: "$5.20",
            engagement: 7,
            content_quality: 7,
            growth_potential: 7,
            production_value: 7,
            brand_fit: 7,
            notes: "Beauty and fashion"
          },
          {
            name: "Science Max",
            show_name: "Science Max",
            audience_size: "520K",
            niche: "Educational",
            youtube_url: "https://www.youtube.com/@ScienceMax",
            cpm: "$5.50",
            rpm: "$4.10",
            engagement: 7,
            content_quality: 8,
            growth_potential: 7,
            production_value: 7,
            brand_fit: 7,
            notes: "Science education"
          },
          {
            name: "Josh Horton",
            show_name: "Josh Horton",
            audience_size: "2.07M",
            niche: "Educational",
            youtube_url: "https://www.youtube.com/@jugglinjosh",
            cpm: "$4.90",
            rpm: "$3.60",
            engagement: 7,
            content_quality: 8,
            growth_potential: 6,
            production_value: 7,
            brand_fit: 7,
            notes: "Juggling tutorials"
          },
          {
            name: "Tiago Forte",
            show_name: "Tiago Forte",
            audience_size: "374K",
            niche: "Educational",
            youtube_url: "https://www.youtube.com/@TiagoForte",
            cpm: "$8.70",
            rpm: "$6.90",
            engagement: 8,
            content_quality: 9,
            growth_potential: 8,
            production_value: 7,
            brand_fit: 8,
            notes: "Productivity education"
          },
          {
            name: "Lisa Bilyeu",
            show_name: "Lisa Bilyeu",
            audience_size: "1.54M",
            niche: "Personal Development",
            youtube_url: "https://www.youtube.com/@LisaBilyeu",
            cpm: "$9.30",
            rpm: "$7.40",
            engagement: 8,
            content_quality: 9,
            growth_potential: 7,
            production_value: 8,
            brand_fit: 9,
            notes: "Empowerment and growth"
          },
          {
            name: "Cajun Koi Academy",
            show_name: "Cajun Koi Academy",
            audience_size: "1.34M",
            niche: "Personal Development",
            youtube_url: "https://www.youtube.com/@KoiAcademy",
            cpm: "$7.10",
            rpm: "$5.40",
            engagement: 8,
            content_quality: 8,
            growth_potential: 7,
            production_value: 7,
            brand_fit: 8,
            notes: "Art and creativity"
          },
          {
            name: "Mathew Encina",
            show_name: "Mathew Encina",
            audience_size: "522K",
            niche: "Personal Development",
            youtube_url: "https://www.youtube.com/@MatthewEncina",
            cpm: "$8.40",
            rpm: "$6.50",
            engagement: 8,
            content_quality: 9,
            growth_potential: 8,
            production_value: 8,
            brand_fit: 8,
            notes: "Creative business development"
          },
          {
            name: "Elizabeth Filips",
            show_name: "Elizabeth Filips",
            audience_size: "987K",
            niche: "Personal Development",
            youtube_url: "https://www.youtube.com/@elizabethfilips",
            cpm: "$7.80",
            rpm: "$6.00",
            engagement: 9,
            content_quality: 9,
            growth_potential: 8,
            production_value: 8,
            brand_fit: 9,
            notes: "Study and productivity"
          },
          {
            name: "Rewirs",
            show_name: "Rewirs",
            audience_size: "2.85M",
            niche: "Personal Development",
            youtube_url: "https://www.youtube.com/@Rewirs",
            cpm: "$6.50",
            rpm: "$4.90",
            engagement: 9,
            content_quality: 8,
            growth_potential: 7,
            production_value: 8,
            brand_fit: 8,
            notes: "Over range but notable"
          },
          {
            name: "Langley Outdoors Academy",
            show_name: "Langley Outdoors Academy",
            audience_size: "720K",
            niche: "Current Events",
            youtube_url: "https://www.youtube.com/@LangleyOutdoors",
            cpm: "$6.80",
            rpm: "$5.10",
            engagement: 7,
            content_quality: 7,
            growth_potential: 7,
            production_value: 7,
            brand_fit: 7,
            notes: "Current events commentary"
          }
        ];

        try {
          const { data, error } = await supabase
            .from('talents')
            .insert(defaultTalents)
            .select();
          
          if (error) throw error;
          
          alert(`Successfully migrated ${defaultTalents.length} talents!`);
          setShowMigration(false);
          await loadTalents();
        } catch (error) {
          console.error('Error migrating data:', error);
          alert('Error migrating data: ' + error.message);
        }
      };

      const updateWeight = (key, value) => {
        setWeights({ ...weights, [key]: value });
      };

      const updateNewTalent = (field, value) => {
        setNewTalent({ ...newTalent, [field]: value });
      };

      const updateEditingTalent = (field, value) => {
        setEditingTalent({ ...editingTalent, [field]: value });
      };

      const getScoreColor = (score) => {
        if (score >= 8) return 'text-emerald-700 bg-emerald-50 border border-emerald-200';
        if (score >= 6) return 'text-amber-700 bg-amber-50 border border-amber-200';
        return 'text-rose-700 bg-rose-50 border border-rose-200';
      };

      const getRankMedal = (index) => {
        return '#' + (index + 1);
      };

      const getCriterionTooltip = (field) => {
        const tooltips = {
          engagement: 'Audience interaction rate: likes, comments, shares, and community involvement with content',
          contentQuality: 'Production quality, storytelling, editing, and overall polish of videos/content',
          content_quality: 'Production quality, storytelling, editing, and overall polish of videos/content',
          growthPotential: 'Trajectory and scalability: trend analysis, audience growth rate, and future opportunity',
          growth_potential: 'Trajectory and scalability: trend analysis, audience growth rate, and future opportunity',
          productionValue: 'Equipment, editing software, production team, and technical execution quality',
          production_value: 'Equipment, editing software, production team, and technical execution quality',
          brandFit: 'Alignment with brand values, target audience overlap, and partnership compatibility',
          brand_fit: 'Alignment with brand values, target audience overlap, and partnership compatibility'
        };
        return tooltips[field] || '';
      };

      if (loading) {
        return h('div', { className: 'min-h-screen p-4 md:p-6 flex items-center justify-center' },
          h('div', { className: 'text-xl text-gray-600' }, 'Loading talents from database...')
        );
      }

      return h('div', { className: 'min-h-screen p-4 md:p-6' },
        h('div', { className: 'max-w-7xl mx-auto' },
          // Header
          h('div', { className: 'bg-gradient-to-br from-cyan-600 to-blue-700 rounded-xl shadow-xl p-6 md:p-8 mb-6 text-white' },
            h('div', { className: 'flex items-center justify-between mb-4 flex-wrap gap-4' },
              h('div', { className: 'flex items-center gap-3' },
                h(AwardIcon),
                h('div', null,
                  h('h1', { className: 'text-3xl md:text-4xl font-bold' },
                    'Talent Ranker'
                  ),
                  h('p', { className: 'text-cyan-50 mt-1 text-sm md:text-base' }, 
                    'Evaluate and rank podcast acquisitions'
                  )
                )
              ),
              h('div', { className: 'flex gap-2' },
                h('button', {
                  onClick: () => setShowAddForm(!showAddForm),
                  className: 'bg-white text-cyan-700 px-4 py-2 rounded-lg hover:bg-cyan-50 transition font-semibold flex items-center gap-2 shadow-lg border-2 border-white'
                },
                  h(PlusIcon),
                  'Add Talent'
                ),
                talents.length === 0 && h('button', {
                  onClick: () => setShowMigration(true),
                  className: 'bg-white/20 text-white px-4 py-2 rounded-lg hover:bg-white/30 transition font-semibold border-2 border-white/40'
                },
                  'Migrate Default Data'
                )
              )
            ),

            // Weights section
            h('div', { className: 'bg-white/20 rounded-lg p-4 mt-6' },
              h('h3', { className: 'font-semibold mb-3 text-lg' }, 'Criteria Weights (%)'),
              h('div', { className: 'grid grid-cols-2 md:grid-cols-5 gap-4' },
                Object.keys(weights).map(key =>
                  h('div', { key: key },
                    h('div', { className: 'tooltip-wrapper block mb-1' },
                      h('label', { className: 'text-sm text-cyan-50 capitalize' },
                        key.replace(/([A-Z])/g, ' $1').trim()
                      ),
                      h('span', { className: 'tooltip-text' }, getCriterionTooltip(key))
                    ),
                    h('input', {
                      type: 'number',
                      min: '0',
                      max: '100',
                      value: weights[key],
                      onChange: (e) => updateWeight(key, parseInt(e.target.value) || 0),
                      className: 'w-full px-3 py-2 border border-white/30 rounded-lg bg-white/90 text-gray-900 placeholder-gray-400 focus:bg-white focus:outline-none focus:ring-2 focus:ring-cyan-300'
                    })
                  )
                )
              ),
              h('div', { className: 'mt-2 text-sm text-cyan-50' },
                'Total: ' + Object.values(weights).reduce((a, b) => a + b, 0) + '%',
                Object.values(weights).reduce((a, b) => a + b, 0) !== 100 &&
                  h('span', { className: 'text-yellow-300 ml-2 font-semibold' }, 'âš  Should equal 100%')
              )
            )
          ),

          // Migration dialog
          showMigration && h('div', { className: 'fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4' },
            h('div', { className: 'bg-white rounded-xl p-6 max-w-md w-full' },
              h('h3', { className: 'text-xl font-bold mb-4' }, 'Migrate Default Data'),
              h('p', { className: 'text-gray-600 mb-6' }, 
                'This will add all 36 default talents to your Supabase database. This is a one-time operation.'
              ),
              h('div', { className: 'flex gap-3' },
                h('button', {
                  onClick: migrateDefaultData,
                  className: 'flex-1 bg-cyan-600 text-white px-4 py-2 rounded-lg hover:bg-cyan-700 font-semibold'
                }, 'Migrate Now'),
                h('button', {
                  onClick: () => setShowMigration(false),
                  className: 'flex-1 bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 font-semibold'
                }, 'Cancel')
              )
            )
          ),

          // Add/Edit form
          (showAddForm || editingTalent) && h('div', { className: 'bg-white rounded-xl shadow-lg p-6 mb-6 border-2 border-cyan-600' },
            h('h3', { className: 'font-bold text-gray-800 mb-4 text-xl' },
              editingTalent ? 'Edit Talent' : 'Add New Talent'
            ),
            h('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-4 mb-4' },
              h('input', {
                type: 'text',
                placeholder: 'Name *',
                value: editingTalent ? editingTalent.name : newTalent.name,
                onChange: (e) => editingTalent ? updateEditingTalent('name', e.target.value) : updateNewTalent('name', e.target.value),
                className: 'px-3 py-2 border-2 border-slate-300 rounded-lg focus:border-cyan-600 focus:outline-none'
              }),
              h('input', {
                type: 'text',
                placeholder: 'Show Name *',
                value: editingTalent ? editingTalent.show_name : newTalent.show_name,
                onChange: (e) => editingTalent ? updateEditingTalent('show_name', e.target.value) : updateNewTalent('show_name', e.target.value),
                className: 'px-3 py-2 border-2 border-slate-300 rounded-lg focus:border-cyan-600 focus:outline-none'
              }),
              h('input', {
                type: 'text',
                placeholder: 'Audience Size (e.g., 50K)',
                value: editingTalent ? editingTalent.audience_size : newTalent.audience_size,
                onChange: (e) => editingTalent ? updateEditingTalent('audience_size', e.target.value) : updateNewTalent('audience_size', e.target.value),
                className: 'px-3 py-2 border-2 border-slate-300 rounded-lg focus:border-cyan-600 focus:outline-none'
              }),
              h('input', {
                type: 'text',
                placeholder: 'Niche',
                value: editingTalent ? editingTalent.niche : newTalent.niche,
                onChange: (e) => editingTalent ? updateEditingTalent('niche', e.target.value) : updateNewTalent('niche', e.target.value),
                className: 'px-3 py-2 border-2 border-slate-300 rounded-lg focus:border-cyan-600 focus:outline-none'
              }),
              h('input', {
                type: 'text',
                placeholder: 'CPM (e.g., $8.50)',
                value: editingTalent ? editingTalent.cpm : newTalent.cpm,
                onChange: (e) => editingTalent ? updateEditingTalent('cpm', e.target.value) : updateNewTalent('cpm', e.target.value),
                className: 'px-3 py-2 border-2 border-slate-300 rounded-lg focus:border-cyan-600 focus:outline-none'
              }),
              h('input', {
                type: 'text',
                placeholder: 'RPM (e.g., $6.20)',
                value: editingTalent ? editingTalent.rpm : newTalent.rpm,
                onChange: (e) => editingTalent ? updateEditingTalent('rpm', e.target.value) : updateNewTalent('rpm', e.target.value),
                className: 'px-3 py-2 border-2 border-slate-300 rounded-lg focus:border-cyan-600 focus:outline-none'
              }),
              h('input', {
                type: 'url',
                placeholder: 'YouTube URL',
                value: editingTalent ? editingTalent.youtube_url : newTalent.youtube_url,
                onChange: (e) => editingTalent ? updateEditingTalent('youtube_url', e.target.value) : updateNewTalent('youtube_url', e.target.value),
                className: 'px-3 py-2 border-2 border-slate-300 rounded-lg md:col-span-2 focus:border-cyan-600 focus:outline-none'
              })
            ),
            
            // Growth metrics
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-semibold text-gray-700 mb-2' }, 'YouTube Growth'),
              h('div', { className: 'grid grid-cols-1 md:grid-cols-3 gap-4' },
                h('input', {
                  type: 'text',
                  placeholder: '28-day (e.g., 5.2%)',
                  value: editingTalent ? editingTalent.growth_28_day : newTalent.growth_28_day,
                  onChange: (e) => editingTalent ? updateEditingTalent('growth_28_day', e.target.value) : updateNewTalent('growth_28_day', e.target.value),
                  className: 'px-3 py-2 border-2 border-slate-300 rounded-lg focus:border-cyan-600 focus:outline-none'
                }),
                h('input', {
                  type: 'text',
                  placeholder: '3-month (e.g., 12.5%)',
                  value: editingTalent ? editingTalent.growth_3_month : newTalent.growth_3_month,
                  onChange: (e) => editingTalent ? updateEditingTalent('growth_3_month', e.target.value) : updateNewTalent('growth_3_month', e.target.value),
                  className: 'px-3 py-2 border-2 border-slate-300 rounded-lg focus:border-cyan-600 focus:outline-none'
                }),
                h('input', {
                  type: 'text',
                  placeholder: '12-month (e.g., 45.8%)',
                  value: editingTalent ? editingTalent.growth_12_month : newTalent.growth_12_month,
                  onChange: (e) => editingTalent ? updateEditingTalent('growth_12_month', e.target.value) : updateNewTalent('growth_12_month', e.target.value),
                  className: 'px-3 py-2 border-2 border-slate-300 rounded-lg focus:border-cyan-600 focus:outline-none'
                })
              )
            ),

            // Social media followers
            h('div', { className: 'mb-4' },
              h('label', { className: 'block text-sm font-semibold text-gray-700 mb-2' }, 'Social Media Followers'),
              h('div', { className: 'grid grid-cols-2 md:grid-cols-3 gap-4' },
                h('input', {
                  type: 'text',
                  placeholder: 'X/Twitter',
                  value: editingTalent ? editingTalent.x_followers : newTalent.x_followers,
                  onChange: (e) => editingTalent ? updateEditingTalent('x_followers', e.target.value) : updateNewTalent('x_followers', e.target.value),
                  className: 'px-3 py-2 border-2 border-slate-300 rounded-lg focus:border-cyan-600 focus:outline-none'
                }),
                h('input', {
                  type: 'text',
                  placeholder: 'Instagram',
                  value: editingTalent ? editingTalent.instagram_followers : newTalent.instagram_followers,
                  onChange: (e) => editingTalent ? updateEditingTalent('instagram_followers', e.target.value) : updateNewTalent('instagram_followers', e.target.value),
                  className: 'px-3 py-2 border-2 border-slate-300 rounded-lg focus:border-cyan-600 focus:outline-none'
                }),
                h('input', {
                  type: 'text',
                  placeholder: 'TikTok',
                  value: editingTalent ? editingTalent.tiktok_followers : newTalent.tiktok_followers,
                  onChange: (e) => editingTalent ? updateEditingTalent('tiktok_followers', e.target.value) : updateNewTalent('tiktok_followers', e.target.value),
                  className: 'px-3 py-2 border-2 border-slate-300 rounded-lg focus:border-cyan-600 focus:outline-none'
                }),
                h('input', {
                  type: 'text',
                  placeholder: 'Snapchat',
                  value: editingTalent ? editingTalent.snapchat_followers : newTalent.snapchat_followers,
                  onChange: (e) => editingTalent ? updateEditingTalent('snapchat_followers', e.target.value) : updateNewTalent('snapchat_followers', e.target.value),
                  className: 'px-3 py-2 border-2 border-slate-300 rounded-lg focus:border-cyan-600 focus:outline-none'
                }),
                h('input', {
                  type: 'text',
                  placeholder: 'Facebook',
                  value: editingTalent ? editingTalent.facebook_followers : newTalent.facebook_followers,
                  onChange: (e) => editingTalent ? updateEditingTalent('facebook_followers', e.target.value) : updateNewTalent('facebook_followers', e.target.value),
                  className: 'px-3 py-2 border-2 border-slate-300 rounded-lg focus:border-cyan-600 focus:outline-none'
                })
              )
            ),

            // Scoring criteria
            h('div', { className: 'grid grid-cols-2 md:grid-cols-5 gap-4 mb-4' },
              ['engagement', 'content_quality', 'growth_potential', 'production_value', 'brand_fit'].map(field =>
                h('div', { key: field },
                  h('label', { className: 'text-sm text-gray-600 capitalize block mb-1 font-semibold' },
                    field.replace(/_/g, ' ').replace(/([A-Z])/g, ' $1').trim() + ' (1-10)'
                  ),
                  h('input', {
                    type: 'number',
                    min: '1',
                    max: '10',
                    value: editingTalent ? editingTalent[field] : newTalent[field],
                    onChange: (e) => editingTalent ? updateEditingTalent(field, parseInt(e.target.value) || 1) : updateNewTalent(field, parseInt(e.target.value) || 1),
                    className: 'w-full px-3 py-2 border-2 border-slate-300 rounded-lg focus:border-cyan-600 focus:outline-none'
                  })
                )
              )
            ),
            h('textarea', {
              placeholder: 'Notes',
              value: editingTalent ? editingTalent.notes : newTalent.notes,
              onChange: (e) => editingTalent ? updateEditingTalent('notes', e.target.value) : updateNewTalent('notes', e.target.value),
              className: 'w-full px-3 py-2 border-2 border-slate-300 rounded-lg mb-4 focus:border-cyan-600 focus:outline-none',
              rows: '2'
            }),
            h('div', { className: 'flex gap-2' },
              h('button', {
                onClick: editingTalent ? updateTalent : addTalent,
                className: 'bg-emerald-600 text-white px-6 py-2 rounded-lg hover:bg-emerald-700 transition font-semibold shadow-md'
              }, editingTalent ? 'Update Talent' : 'Add Talent'),
              h('button', {
                onClick: () => {
                  setShowAddForm(false);
                  setEditingTalent(null);
                },
                className: 'bg-slate-300 text-slate-700 px-6 py-2 rounded-lg hover:bg-slate-400 transition font-semibold'
              }, 'Cancel')
            )
          ),

          // Search and sort controls
          h('div', { className: 'bg-white rounded-xl shadow-lg p-4 mb-6' },
            h('div', { className: 'flex flex-col md:flex-row items-stretch md:items-center gap-4' },
              h('div', { className: 'relative flex-1' },
                h('div', { className: 'absolute left-3 top-1/2 transform -translate-y-1/2 text-cyan-600' },
                  h(SearchIcon)
                ),
                h('input', {
                  type: 'text',
                  placeholder: 'Search by name (also searches niche, CPM, RPM)...',
                  value: searchQuery,
                  onChange: (e) => setSearchQuery(e.target.value),
                  className: 'w-full pl-10 pr-10 py-3 border-2 border-slate-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 focus:outline-none'
                }),
                searchQuery && h('button', {
                  onClick: () => setSearchQuery(''),
                  className: 'absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 text-xl'
                }, 'âœ•')
              ),
              h('div', { className: 'flex items-center gap-2' },
                h('span', { className: 'text-gray-700 font-semibold whitespace-nowrap' }, 'Sort by:'),
                h('select', {
                  value: sortBy,
                  onChange: (e) => setSortBy(e.target.value),
                  className: 'px-4 py-3 border-2 border-slate-300 rounded-lg font-semibold focus:border-cyan-600 focus:outline-none'
                },
                  h('option', { value: 'score' }, 'Score (Highest First)'),
                  h('option', { value: 'name' }, 'Name (A-Z)'),
                  h('option', { value: 'niche' }, 'Niche'),
                  h('option', { value: 'revenue' }, 'Revenue (High to Low)')
                )
              )
            ),

            h('div', { className: 'mt-4 flex items-center gap-2 flex-wrap' },
              h('span', { className: 'text-sm font-semibold text-gray-700' }, 'Revenue Filter:'),
              h('button', {
                onClick: () => setRevenueFilter('all'),
                className: 'px-4 py-2 rounded-lg font-semibold text-sm transition ' + (revenueFilter === 'all' ? 'bg-cyan-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300')
              }, 'All'),
              h('button', {
                onClick: () => setRevenueFilter('high'),
                className: 'px-4 py-2 rounded-lg font-semibold text-sm transition ' + (revenueFilter === 'high' ? 'bg-purple-600 text-white' : 'bg-purple-100 text-purple-700 hover:bg-purple-200')
              }, 'High (â‰¥$9)'),
              h('button', {
                onClick: () => setRevenueFilter('medium'),
                className: 'px-4 py-2 rounded-lg font-semibold text-sm transition ' + (revenueFilter === 'medium' ? 'bg-yellow-600 text-white' : 'bg-yellow-100 text-yellow-700 hover:bg-yellow-200')
              }, 'Medium ($6-9)'),
              h('button', {
                onClick: () => setRevenueFilter('low'),
                className: 'px-4 py-2 rounded-lg font-semibold text-sm transition ' + (revenueFilter === 'low' ? 'bg-slate-600 text-white' : 'bg-slate-200 text-slate-700 hover:bg-slate-300')
              }, 'Low (<$6)')
            ),

            searchQuery && h('div', { className: 'mt-3 text-sm text-gray-600 font-medium' },
              'Showing ' + sortedTalents.length + ' of ' + talents.length + ' talents'
            ),
            
            revenueFilter !== 'all' && !searchQuery && h('div', { className: 'mt-3 text-sm text-gray-600 font-medium' },
              'Showing ' + sortedTalents.length + ' ' + revenueFilter + ' revenue talents'
            )
          ),

          // Talent cards
          h('div', { className: 'space-y-4' },
            sortedTalents.map((talent, index) =>
              h('div', { key: talent.id, className: 'bg-white rounded-xl shadow-lg p-6 card-hover' },
                h('div', { className: 'flex items-start justify-between mb-4 gap-4' },
                  h('div', { className: 'flex items-start gap-4 flex-1' },
                    h('div', { className: 'text-2xl md:text-3xl font-bold text-slate-400 min-w-[60px]' },
                      getRankMedal(index)
                    ),
                    h('div', { className: 'flex-1 min-w-0' },
                      h('div', { className: 'flex items-center gap-3 mb-2 flex-wrap' },
                        h('h2', { className: 'text-xl md:text-2xl font-bold text-slate-800' }, talent.name),
                        h('span', { className: 'px-3 py-1 rounded-full text-sm font-bold ' + getScoreColor(talent.score) },
                          'Score: ' + talent.score + '/10'
                        )
                      ),
                      h('div', { className: 'flex items-center gap-4 text-sm md:text-base text-gray-600 mb-3 flex-wrap' },
                        h('span', { className: 'font-semibold text-slate-700' }, talent.show_name),
                        talent.audience_size && h('span', { className: 'text-sm' },
                          'YT Subs: ' + talent.audience_size
                        ),
                        talent.niche && h('span', { className: 'px-2 py-1 bg-cyan-100 text-cyan-800 rounded font-semibold text-sm border border-cyan-200' },
                          talent.niche
                        )
                      ),
                      
                      // Revenue metrics
                      (talent.cpm || talent.rpm) && h('div', { className: 'flex items-center gap-4 mb-3 flex-wrap' },
                        talent.cpm && h('span', { className: 'flex items-center gap-1 text-sm bg-emerald-50 px-3 py-1 rounded-lg border border-emerald-200' },
                          h(DollarIcon),
                          h('span', { className: 'font-semibold text-emerald-700' }, 'CPM: ' + talent.cpm)
                        ),
                        talent.rpm && h('span', { className: 'flex items-center gap-1 text-sm bg-blue-50 px-3 py-1 rounded-lg border border-blue-200' },
                          h(DollarIcon),
                          h('span', { className: 'font-semibold text-blue-700' }, 'RPM: ' + talent.rpm)
                        ),
                        (talent.cpm || talent.rpm) && (() => {
                          const tranche = getRevenueTrancheLabel(talent);
                          const colors = {
                            'high': 'bg-purple-100 text-purple-700 border-purple-300',
                            'medium': 'bg-yellow-100 text-yellow-700 border-yellow-300',
                            'low': 'bg-slate-100 text-slate-700 border-slate-300'
                          };
                          return h('span', { className: 'px-3 py-1 rounded-lg border text-xs font-bold uppercase ' + colors[tranche] },
                            tranche + ' revenue'
                          );
                        })()
                      ),

                      // Growth metrics
                      (talent.growth_28_day || talent.growth_3_month || talent.growth_12_month) && h('div', { className: 'flex items-center gap-3 mb-3 flex-wrap' },
                        h('div', { className: 'flex items-center gap-1 text-xs font-semibold text-gray-600' },
                          h(TrendingUpIcon),
                          'Growth:'
                        ),
                        talent.growth_28_day && h('span', { className: 'text-xs bg-indigo-50 px-2 py-1 rounded border border-indigo-200 text-indigo-700' },
                          '28d: ' + talent.growth_28_day
                        ),
                        talent.growth_3_month && h('span', { className: 'text-xs bg-indigo-50 px-2 py-1 rounded border border-indigo-200 text-indigo-700' },
                          '3m: ' + talent.growth_3_month
                        ),
                        talent.growth_12_month && h('span', { className: 'text-xs bg-indigo-50 px-2 py-1 rounded border border-indigo-200 text-indigo-700' },
                          '12m: ' + talent.growth_12_month
                        )
                      ),

                      // Social media
                      (talent.x_followers || talent.instagram_followers || talent.tiktok_followers || talent.snapchat_followers || talent.facebook_followers) && h('div', { className: 'flex items-center gap-3 mb-3 flex-wrap' },
                        h('div', { className: 'text-xs font-semibold text-gray-600' }, 'Socials:'),
                        talent.x_followers && h('span', { className: 'text-xs bg-slate-50 px-2 py-1 rounded border border-slate-200 text-slate-700' },
                          'X: ' + talent.x_followers
                        ),
                        talent.instagram_followers && h('span', { className: 'text-xs bg-pink-50 px-2 py-1 rounded border border-pink-200 text-pink-700' },
                          'IG: ' + talent.instagram_followers
                        ),
                        talent.tiktok_followers && h('span', { className: 'text-xs bg-slate-50 px-2 py-1 rounded border border-slate-200 text-slate-700' },
                          'TT: ' + talent.tiktok_followers
                        ),
                        talent.snapchat_followers && h('span', { className: 'text-xs bg-yellow-50 px-2 py-1 rounded border border-yellow-200 text-yellow-700' },
                          'SC: ' + talent.snapchat_followers
                        ),
                        talent.facebook_followers && h('span', { className: 'text-xs bg-blue-50 px-2 py-1 rounded border border-blue-200 text-blue-700' },
                          'FB: ' + talent.facebook_followers
                        )
                      ),
                      
                      // YouTube link
                      talent.youtube_url && h('a', {
                        href: talent.youtube_url,
                        target: '_blank',
                        rel: 'noopener noreferrer',
                        className: 'inline-flex items-center gap-2 text-red-600 hover:text-red-700 font-semibold text-sm mb-3 hover:underline'
                      },
                        h(YoutubeIcon),
                        'View YouTube Channel',
                        h(ExternalLinkIcon)
                      ),
                      talent.notes && h('p', { className: 'text-gray-600 text-sm italic mt-2' }, talent.notes)
                    )
                  ),
                  h('div', { className: 'flex gap-2' },
                    h('button', {
                      onClick: () => setEditingTalent(talent),
                      className: 'text-cyan-600 hover:text-cyan-800 transition text-sm font-semibold'
                    }, 'Edit'),
                    h('button', {
                      onClick: () => deleteTalent(talent.id),
                      className: 'text-red-500 hover:text-red-700 transition flex-shrink-0'
                    }, h(TrashIcon))
                  )
                ),

                h('div', { className: 'border-t border-gray-200 my-4' }),

                // Scoring bars
                h('div', { className: 'grid grid-cols-2 md:grid-cols-5 gap-4' },
                  ['engagement', 'content_quality', 'growth_potential', 'production_value', 'brand_fit'].map(field =>
                    h('div', { key: field },
                      h('div', { className: 'flex items-center justify-between mb-1' },
                        h('div', { className: 'tooltip-wrapper' },
                          h('label', { className: 'text-xs text-gray-600 capitalize font-semibold' },
                            field.replace(/_/g, ' ')
                          ),
                          h('span', { className: 'tooltip-text' }, getCriterionTooltip(field))
                        ),
                        h('span', { className: 'text-xs font-bold text-cyan-700' }, talent[field] + '/10')
                      ),
                      h('div', { className: 'h-2.5 bg-slate-200 rounded-full overflow-hidden' },
                        h('div', {
                          className: 'h-full bg-gradient-to-r from-cyan-500 to-blue-600 transition-all',
                          style: { width: (talent[field] / 10 * 100) + '%' }
                        })
                      )
                    )
                  )
                )
              )
            )
          ),

          // Empty states
          sortedTalents.length === 0 && talents.length > 0 && h('div', { className: 'bg-white rounded-xl shadow-lg p-12 text-center border-2 border-cyan-600' },
            h('p', { className: 'text-gray-500 text-lg' }, 'No talents match your search. Try different keywords.')
          ),

          talents.length === 0 && h('div', { className: 'bg-white rounded-xl shadow-lg p-12 text-center border-2 border-cyan-600' },
            h('p', { className: 'text-gray-500 text-lg mb-4' }, 'No talents in database yet.'),
            h('button', {
              onClick: () => setShowMigration(true),
              className: 'bg-cyan-600 text-white px-6 py-3 rounded-lg hover:bg-cyan-700 transition font-semibold'
            }, 'Migrate Default Data')
          )
        )
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('app'));
    root.render(h(App));
    }); // End of window.addEventListener
  </script>
</body>
</html>
